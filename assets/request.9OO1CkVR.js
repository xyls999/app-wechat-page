var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(t,r,a)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a,i=(e,i)=>{for(var s in i||(i={}))r.call(i,s)&&o(e,s,i[s]);if(t)for(var s of t(i))a.call(i,s)&&o(e,s,i[s]);return e},s=(e,t,r)=>new Promise((a,o)=>{var i=e=>{try{n(r.next(e))}catch(t){o(t)}},s=e=>{try{n(r.throw(e))}catch(t){o(t)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,s);n((r=r.apply(e,t)).next())});import{y as n,U as l,z as c,s as u,V as d,W as p,g as h,X as m}from"./index-Py9d2018.js";const f="https://wechat-manage.onrender.com",v={AUTH:{REGISTER:`${f}/api/v1/auth/register`,LOGIN:`${f}/api/v1/auth/login`,LOGOUT:`${f}/api/v1/auth/logout`,PROFILE:`${f}/api/v1/user/profile`},FILE:{UPLOAD:`${f}/api/v1/files/upload`,PROCESS:`${f}/api/v1/files/process`,DOWNLOAD:`${f}/api/v1/files/download`,PREVIEW:`${f}/api/v1/files/preview`},HISTORY:{LIST:`${f}/api/v1/files/history`,DETAIL:`${f}/api/v1/files/detail`,DELETE:`${f}/api/v1/files`,CLEAR:`${f}/api/v1/files/history/clear`},AI:{CHAT:`${f}/api/v1/ai/chat`,HISTORY:`${f}/api/v1/ai/history`}};function E(){const e=m("token");return e?{Authorization:`Bearer ${e}`}:{}}function P(e){return s(this,null,function*(){const{url:t,method:r="GET",data:a,header:o={},showLoading:s=!0,loadingText:l="加载中...",timeout:m=3e4}=e;s&&n({title:l,mask:!0});try{const e=yield new Promise((e,s)=>{d({url:t.startsWith("http")?t:`${f}${t}`,method:r,data:a,header:i(i({"Content-Type":"application/json"},E()),o),timeout:m,success:e,fail:s})});s&&c();const n=e.data;return 200!==n.code&&0!==n.code?401===n.code?(p("token"),p("userInfo"),h({url:"/pages/login/index"}),Promise.reject(new Error("登录已过期，请重新登录"))):Promise.reject(new Error(n.message||"请求失败")):n}catch(v){s&&c();const e=(null==v?void 0:v.errMsg)||(null==v?void 0:v.message)||"网络请求失败";return u({title:e,icon:"none"}),Promise.reject(v)}})}const g={get:(e,t,r)=>P(i({url:e,method:"GET",data:t},r)),post:(e,t,r)=>P(i({url:e,method:"POST",data:t},r)),put:(e,t,r)=>P(i({url:e,method:"PUT",data:t},r)),delete:(e,t,r)=>P(i({url:e,method:"DELETE",data:t},r)),upload:(e,t,r)=>function(e){return s(this,null,function*(){const{url:t,filePath:r,name:a="file",formData:o={},showLoading:s=!0,loadingText:d="上传中...",timeout:p=6e4}=e;s&&n({title:d,mask:!0});try{const e=yield new Promise((e,s)=>{l({url:t.startsWith("http")?t:`${f}${t}`,filePath:r,name:a,formData:o,header:i({},E()),timeout:p,success:e,fail:s})});s&&c();const n=JSON.parse(e.data);return 200!==n.code&&0!==n.code?Promise.reject(new Error(n.message||"上传失败")):n}catch(h){s&&c();const e=(null==h?void 0:h.errMsg)||(null==h?void 0:h.message)||"上传失败";return u({title:e,icon:"none"}),Promise.reject(h)}})}(i({url:e,filePath:t},r))};export{v as A,g as h};
