var e=(e,l,a)=>new Promise((s,t)=>{var i=e=>{try{n(a.next(e))}catch(l){t(l)}},c=e=>{try{n(a.throw(e))}catch(l){t(l)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(i,c);n((a=a.apply(e,l)).next())});import{d as l,u as a,v as s,r as t,B as i,h as c,c as n,w as o,i as u,o as r,a as f,b as d,e as _,n as m,S as v,k as p,F as y,l as h,t as g,m as k,x as F,j as C,p as b,y as w,z as x,s as E,q as H,A as I}from"./index-lP-d8iD-.js";import{h as A,A as S}from"./request.BON3x-Ti.js";import{A as T}from"./AiAssistant.C5TzL7Ct.js";import{E as $}from"./ExcelPreview.DZ4XglH4.js";import{_ as j}from"./_plugin-vue_export-helper.BCo6x5W8.js";const R=j(l({__name:"index",setup(l){const j=a(),R=s(),L=t(!1),O=t("all"),B=t(!1),P=t([]),z=i(()=>"all"===O.value?R.fileHistory:"original"===O.value?R.originalFiles:R.processedFiles);function D(e){return{pending:"å¾…å¤„ç†",processing:"å¤„ç†ä¸­",completed:"å·²å®Œæˆ",failed:"å¤„ç†å¤±è´¥"}[e]||e}function N(){b({url:"/pages/excel/index"})}function Y(){return e(this,null,function*(){0!==R.fileHistory.length?H({title:"ç¡®è®¤æ¸…ç©º",content:`${j.userHonorific}ï¼Œç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰åŽ†å²è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`,confirmColor:"#F44336",success:l=>e(this,null,function*(){if(l.confirm)try{yield A.delete(S.HISTORY.CLEAR),R.clearHistory(),E({title:"å·²æ¸…ç©º",icon:"success"})}catch(e){R.clearHistory(),E({title:"å·²æ¸…ç©º",icon:"success"})}})}):E({title:"æš‚æ— è®°å½•å¯æ¸…ç©º",icon:"none"})})}function q(){I()}return c(()=>{!function(){e(this,null,function*(){L.value=!0;try{const e=yield A.get(S.HISTORY.LIST,null,{loadingText:""});e.data&&e.data.records&&R.syncFromServer(e.data.records)}catch(e){R.initFromStorage()}finally{L.value=!1}})}()}),(l,a)=>{const s=u,t=d,i=v;return r(),n(s,{class:"history-container"},{default:o(()=>[f(s,{class:"bg-glow glow-1"}),f(s,{class:"bg-glow glow-2"}),f(s,{class:"nav-header"},{default:o(()=>[f(s,{class:"nav-back",onClick:q},{default:o(()=>[f(t,{class:"back-icon"},{default:o(()=>[_("â€¹")]),_:1})]),_:1}),f(t,{class:"nav-title"},{default:o(()=>[_("åŽ†å²è®°å½•")]),_:1}),f(s,{class:"nav-action",onClick:Y},{default:o(()=>[f(t,null,{default:o(()=>[_("æ¸…ç©º")]),_:1})]),_:1})]),_:1}),f(s,{class:"tabs-section"},{default:o(()=>[f(s,{class:m(["tab-item",{active:"all"===O.value}]),onClick:a[0]||(a[0]=e=>O.value="all")},{default:o(()=>[f(t,null,{default:o(()=>[_("å…¨éƒ¨")]),_:1})]),_:1},8,["class"]),f(s,{class:m(["tab-item",{active:"original"===O.value}]),onClick:a[1]||(a[1]=e=>O.value="original")},{default:o(()=>[f(t,null,{default:o(()=>[_("åŽŸå§‹")]),_:1})]),_:1},8,["class"]),f(s,{class:m(["tab-item",{active:"processed"===O.value}]),onClick:a[2]||(a[2]=e=>O.value="processed")},{default:o(()=>[f(t,null,{default:o(()=>[_("å·²å¤„ç†")]),_:1})]),_:1},8,["class"])]),_:1}),f(s,{class:"file-list"},{default:o(()=>[f(i,{class:"file-scroll","scroll-y":""},{default:o(()=>[z.value.length>0?(r(),n(s,{key:0,class:"file-items"},{default:o(()=>[(r(!0),p(y,null,h(z.value,l=>(r(),n(s,{key:l.id,class:"file-item"},{default:o(()=>[f(t,{class:"file-emoji"},{default:o(()=>[_(g("original"===l.fileType?"ðŸ“Š":"âœ¨"),1)]),_:2},1024),f(s,{class:"file-info"},{default:o(()=>[f(t,{class:"file-name"},{default:o(()=>[_(g(l.fileName),1)]),_:2},1024),f(s,{class:"file-meta"},{default:o(()=>{return[f(t,{class:"file-size"},{default:o(()=>{return[_(g((e=l.fileSize,e<1024?e+" B":e<1048576?(e/1024).toFixed(1)+" KB":(e/1048576).toFixed(2)+" MB")),1)];var e}),_:2},1024),f(t,{class:"file-status",style:k({color:(e=l.status,{pending:"#FF9800",processing:"#2196F3",completed:"#4CAF50",failed:"#F44336"}[e]||"#999")})},{default:o(()=>[_(g(D(l.status)),1)]),_:2},1032,["style"])];var e}),_:2},1024)]),_:2},1024),f(s,{class:"file-actions"},{default:o(()=>[f(s,{class:"action-btn",onClick:F(a=>function(l){return e(this,null,function*(){try{const e=yield A.get(`${S.FILE.PREVIEW}/${l.fileId}`,null,{loadingText:"åŠ è½½é¢„è§ˆ..."});P.value=e.data.rows||[],B.value=!0}catch(e){P.value=[{"ä¼šè®¡æœˆ":"202501","æœŸåˆæ•°é‡":700,"æ— ç¨ŽæœŸåˆé‡‘é¢":25695.57},{"ä¼šè®¡æœˆ":"202502","æœŸåˆæ•°é‡":0,"æ— ç¨ŽæœŸåˆé‡‘é¢":0}],B.value=!0}})}(l),["stop"])},{default:o(()=>[_("ðŸ‘ï¸")]),_:2},1032,["onClick"]),f(s,{class:"action-btn",onClick:F(e=>function(e){const l=e.downloadUrl||`${S.FILE.DOWNLOAD}/${e.fileId}`;w({title:"å‡†å¤‡ä¸‹è½½..."});const a=document.createElement("a");a.href=l,a.download=e.name||e.fileName,a.click(),x(),E({title:"ä¸‹è½½å·²å¼€å§‹",icon:"success"})}(l),["stop"])},{default:o(()=>[_("ðŸ“¥")]),_:2},1032,["onClick"]),f(s,{class:"action-btn del",onClick:F(a=>function(l){return e(this,null,function*(){H({title:"ç¡®è®¤åˆ é™¤",content:`${j.userHonorific}ï¼Œç¡®å®šè¦åˆ é™¤è¿™æ¡è®°å½•å—ï¼Ÿ`,confirmColor:"#F44336",success:a=>e(this,null,function*(){if(a.confirm)try{yield A.delete(`${S.HISTORY.DELETE}/${l.id}`),R.removeFileRecord(l.id),E({title:"åˆ é™¤æˆåŠŸ",icon:"success"})}catch(e){R.removeFileRecord(l.id),E({title:"åˆ é™¤æˆåŠŸ",icon:"success"})}})})})}(l),["stop"])},{default:o(()=>[_("ðŸ—‘ï¸")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):(r(),n(s,{key:1,class:"empty-state"},{default:o(()=>[f(t,{class:"empty-icon"},{default:o(()=>[_("ðŸ“­")]),_:1}),f(t,{class:"empty-title"},{default:o(()=>[_("æš‚æ— è®°å½•")]),_:1}),f(t,{class:"empty-desc"},{default:o(()=>[_(g(C(j).userHonorific)+"ï¼Œæ‚¨è¿˜æ²¡æœ‰å¤„ç†è¿‡æ–‡ä»¶å“¦~",1)]),_:1}),f(s,{class:"empty-btn",onClick:N},{default:o(()=>[f(t,null,{default:o(()=>[_("åŽ»å¤„ç†è¡¨æ ¼")]),_:1})]),_:1})]),_:1}))]),_:1})]),_:1}),f(s,{class:"footer-tip"},{default:o(()=>[f(t,null,{default:o(()=>[_("ðŸ’¾ ç³»ç»Ÿè‡ªåŠ¨ä¿å­˜æœ€è¿‘20æ¡è®°å½•")]),_:1})]),_:1}),f($,{show:B.value,"onUpdate:show":a[3]||(a[3]=e=>B.value=e),data:P.value},null,8,["show","data"]),f(T)]),_:1})}}}),[["__scopeId","data-v-c845360a"]]);export{R as default};
