import{d as e,u as a,r as l,c as s,w as n,i as t,o as u,a as o,b as i,e as r,t as c,I as d,f as m,n as p,s as f,g as v}from"./index-CX6JEdN2.js";import{h as _,A as w}from"./request.DbODBbG2.js";import{_ as g}from"./_plugin-vue_export-helper.BCo6x5W8.js";const h=g(e({__name:"index",setup(e){const g=a(),h=l(!0),k=l({username:"",password:"",confirmPassword:"",nickname:""}),x=l(!1);function y(){h.value=!h.value,k.value={username:"",password:"",confirmPassword:"",nickname:""}}function V(){return e=this,a=null,l=function*(){var e;if(function(){if(!k.value.username.trim())return f({title:"è¯·è¾“å…¥ç”¨æˆ·å",icon:"none"}),!1;if(k.value.username.length<3)return f({title:"ç”¨æˆ·åè‡³å°‘3ä¸ªå­—ç¬¦",icon:"none"}),!1;if(!k.value.password)return f({title:"è¯·è¾“å…¥å¯†ç ",icon:"none"}),!1;if(k.value.password.length<6)return f({title:"å¯†ç è‡³å°‘6ä½",icon:"none"}),!1;if(!h.value){if(k.value.password!==k.value.confirmPassword)return f({title:"ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´",icon:"none"}),!1;if(!k.value.nickname.trim())return f({title:"è¯·è¾“å…¥æ‚¨çš„ç§°å‘¼",icon:"none"}),!1}return!0}()){x.value=!0;try{if(h.value){const a=(yield _.post(w.AUTH.LOGIN,{username:k.value.username,password:k.value.password},{showLoading:!1})).data,l=a.token,s={id:a.id,username:a.username,nickname:a.nickname,avatar:a.avatar};g.login(s,l);const n=(null==(e=s.nickname)?void 0:e.charAt(0))||s.username.charAt(0);f({title:`${n}æ€»ï¼Œæ¬¢è¿å›æ¥ï¼`,icon:"success",duration:2e3}),setTimeout(()=>{v({url:"/pages/home/index"})},1500)}else{const e=(yield _.post(w.AUTH.REGISTER,{username:k.value.username,password:k.value.password,nickname:k.value.nickname},{showLoading:!1})).data,a=e.token,l={id:e.id,username:e.username,nickname:e.nickname,avatar:e.avatar},s=k.value.nickname.charAt(0);f({title:`${s}æ€»ï¼Œæ³¨å†ŒæˆåŠŸï¼`,icon:"success"}),g.login(l,a),setTimeout(()=>{v({url:"/pages/home/index"})},1500)}}catch(a){f({title:a.message||"æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•",icon:"none"})}finally{x.value=!1}}},new Promise((s,n)=>{var t=e=>{try{o(l.next(e))}catch(a){n(a)}},u=e=>{try{o(l.throw(e))}catch(a){n(a)}},o=e=>e.done?s(e.value):Promise.resolve(e.value).then(t,u);o((l=l.apply(e,a)).next())});var e,a,l}return(e,a)=>{const l=t,f=i,v=d;return u(),s(l,{class:"login-container"},{default:n(()=>[o(l,{class:"bg-glow glow-1"}),o(l,{class:"bg-glow glow-2"}),o(l,{class:"bg-glow glow-3"}),o(l,{class:"logo-section"},{default:n(()=>[o(l,{class:"logo-icon"},{default:n(()=>[o(f,{class:"logo-text"},{default:n(()=>[r("ğŸ“Š")]),_:1})]),_:1}),o(f,{class:"app-title"},{default:n(()=>[r("æ™ºæ…§è¡¨æ ¼åŠ©æ‰‹")]),_:1})]),_:1}),o(l,{class:"form-section"},{default:n(()=>[o(f,{class:"form-title"},{default:n(()=>[r(c(h.value?"æ¬¢è¿å›æ¥":"åˆ›å»ºè´¦å·"),1)]),_:1}),o(l,{class:"input-group"},{default:n(()=>[o(l,{class:"input-wrapper"},{default:n(()=>[o(f,{class:"input-icon"},{default:n(()=>[r("ğŸ‘¤")]),_:1}),o(v,{modelValue:k.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>k.value.username=e),class:"input-field",placeholder:"è¯·è¾“å…¥ç”¨æˆ·å",maxlength:20},null,8,["modelValue"])]),_:1})]),_:1}),h.value?m("",!0):(u(),s(l,{key:0,class:"input-group"},{default:n(()=>[o(l,{class:"input-wrapper"},{default:n(()=>[o(f,{class:"input-icon"},{default:n(()=>[r("ğŸ“›")]),_:1}),o(v,{modelValue:k.value.nickname,"onUpdate:modelValue":a[1]||(a[1]=e=>k.value.nickname=e),class:"input-field",placeholder:"æ‚¨çš„ç§°å‘¼ï¼ˆå¦‚ï¼šå¼ ä¸‰ï¼‰",maxlength:10},null,8,["modelValue"])]),_:1}),o(f,{class:"input-hint"},{default:n(()=>[r('æˆ‘ä»¬å°†ç§°å‘¼æ‚¨ä¸º"Xæ€»"')]),_:1})]),_:1})),o(l,{class:"input-group"},{default:n(()=>[o(l,{class:"input-wrapper"},{default:n(()=>[o(f,{class:"input-icon"},{default:n(()=>[r("ğŸ”’")]),_:1}),o(v,{modelValue:k.value.password,"onUpdate:modelValue":a[2]||(a[2]=e=>k.value.password=e),class:"input-field",password:"",placeholder:"è¯·è¾“å…¥å¯†ç ",maxlength:20},null,8,["modelValue"])]),_:1})]),_:1}),h.value?m("",!0):(u(),s(l,{key:1,class:"input-group"},{default:n(()=>[o(l,{class:"input-wrapper"},{default:n(()=>[o(f,{class:"input-icon"},{default:n(()=>[r("ğŸ”")]),_:1}),o(v,{modelValue:k.value.confirmPassword,"onUpdate:modelValue":a[3]||(a[3]=e=>k.value.confirmPassword=e),class:"input-field",password:"",placeholder:"è¯·å†æ¬¡è¾“å…¥å¯†ç ",maxlength:20},null,8,["modelValue"])]),_:1})]),_:1})),o(l,{class:p(["submit-btn",{loading:x.value}]),onClick:V},{default:n(()=>[x.value?(u(),s(l,{key:1,class:"btn-spinner"})):(u(),s(f,{key:0},{default:n(()=>[r(c(h.value?"ç™» å½•":"æ³¨ å†Œ"),1)]),_:1}))]),_:1},8,["class"]),o(l,{class:"switch-mode",onClick:y},{default:n(()=>[h.value?(u(),s(f,{key:0},{default:n(()=>[r("è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ"),o(f,{class:"link"},{default:n(()=>[r("ç«‹å³æ³¨å†Œ")]),_:1})]),_:1})):(u(),s(f,{key:1},{default:n(()=>[r("å·²æœ‰è´¦å·ï¼Ÿ"),o(f,{class:"link"},{default:n(()=>[r("ç«‹å³ç™»å½•")]),_:1})]),_:1}))]),_:1})]),_:1}),o(l,{class:"footer-tip"},{default:n(()=>[o(f,null,{default:n(()=>[r("ğŸŒ¿ ç”¨å¿ƒæœåŠ¡ï¼Œè®©æ‚¨çœå¿ƒ ğŸŒ¿")]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-1a56e704"]]);export{h as default};
